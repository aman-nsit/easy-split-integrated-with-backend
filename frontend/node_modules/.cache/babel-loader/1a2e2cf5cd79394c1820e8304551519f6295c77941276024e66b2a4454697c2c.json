{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Aman\\\\Desktop\\\\split-expense\\\\frontend\\\\src\\\\components\\\\AuthStore.js\";\nimport React from 'react';\nimport { create } from \"zustand\";\nimport axios from \"axios\";\nimport { Navigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst authStore = create(set => ({\n  loggedIn: null,\n  loginForm: {\n    email: \"\",\n    password: \"\"\n  },\n  updateLoginForm: e => {\n    const {\n      name,\n      value\n    } = e.target;\n    set(state => {\n      return {\n        loginForm: {\n          ...state.loginForm,\n          [name]: value\n        }\n      };\n    });\n  },\n  login: async () => {\n    try {\n      const {\n        loginForm\n      } = authStore.getState();\n      // const item =localStorage.getItem('accesstoken');\n      // console.log(item)\n      console.log(loginForm);\n      const res = await axios.post(\"/users/login\", loginForm);\n      console.log(res);\n      // localStorage.setItem(res.data)\n      // console.log(res.data.accesstoken);\n      // localStorage.setItem(\"accesstoken\",res.data.accesstoken)\n      set({\n        loggedIn: true,\n        loginForm: {\n          email: \"\",\n          password: \"\"\n        }\n      });\n    } catch (err) {\n      console.log(err);\n    }\n  },\n  checkAuth: async () => {\n    try {\n      // await axios.get(\"/check-auth\", {withCredentials: true}); // not rquire set default in index.js\n      // await axios.get(\"/check-auth\");\n      // set({loggedIn : true});\n\n      const authCheckPromise = axios.get(\"/users/check-auth\");\n      await Promise.race([authCheckPromise, new Promise(resolve => setTimeout(resolve, 50000))]);\n      set({\n        loggedIn: true\n      });\n    } catch (err) {\n      set({\n        loggedIn: false\n      });\n      console.log(err);\n      return /*#__PURE__*/_jsxDEV(Navigate, {\n        to: \"/users/login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }, this);\n    }\n  },\n  signUpForm: {\n    name: \"\",\n    user_name: \"\",\n    email: \"\",\n    password: \"\"\n  },\n  updateSignUpForm: e => {\n    const {\n      name,\n      value\n    } = e.target;\n    set(state => {\n      return {\n        signUpForm: {\n          ...state.signUpForm,\n          [name]: value\n        }\n      };\n    });\n  },\n  signUp: async () => {\n    try {\n      const {\n        signUpForm\n      } = authStore.getState();\n      console.log(signUpForm);\n      const res = await axios.post(\"/users/signup\", signUpForm, {\n        withCredentials: true\n      });\n      set({\n        signUpForm: {\n          user_name: \"\",\n          email: \"\",\n          password: \"\"\n        }\n      });\n      console.log(res);\n    } catch (err) {\n      console.log(err);\n    }\n  },\n  logOut: async () => {\n    try {\n      const res = await axios.get(\"/users/logout\");\n      // localStorage.clear();\n      set({\n        loggedIn: false\n      });\n      console.log(\"logged_out\");\n    } catch (err) {\n      console.log(err);\n    }\n  }\n}));\nexport default authStore;","map":{"version":3,"names":["React","create","axios","Navigate","jsxDEV","_jsxDEV","authStore","set","loggedIn","loginForm","email","password","updateLoginForm","e","name","value","target","state","login","getState","console","log","res","post","err","checkAuth","authCheckPromise","get","Promise","race","resolve","setTimeout","to","fileName","_jsxFileName","lineNumber","columnNumber","signUpForm","user_name","updateSignUpForm","signUp","withCredentials","logOut"],"sources":["C:/Users/Aman/Desktop/split-expense/frontend/src/components/AuthStore.js"],"sourcesContent":["import React from 'react';\r\nimport {create} from \"zustand\" ;\r\nimport  axios from \"axios\";\r\nimport { Navigate } from 'react-router-dom';\r\nconst authStore = create((set) => ({\r\n    loggedIn : null ,\r\n\r\n    loginForm:{\r\n        email:\"\",\r\n        password : \"\",\r\n    },\r\n    updateLoginForm :(e) => {\r\n        const {name , value} = e.target ;\r\n        set((state) => {\r\n            return{\r\n                loginForm:{\r\n                    ...state.loginForm,\r\n                    [name] : value\r\n                },\r\n            };\r\n        });\r\n    },\r\n    login : async () =>{\r\n        try{\r\n            const {loginForm} = authStore.getState();\r\n            // const item =localStorage.getItem('accesstoken');\r\n            // console.log(item)\r\n            console.log(loginForm);\r\n            const res = await axios.post(\"/users/login\",loginForm) \r\n            console.log(res); \r\n            // localStorage.setItem(res.data)\r\n            // console.log(res.data.accesstoken);\r\n            // localStorage.setItem(\"accesstoken\",res.data.accesstoken)\r\n            set(\r\n                {loggedIn:true ,    \r\n                loginForm : {\r\n                    email : \"\",\r\n                    password : \"\"\r\n                }\r\n            });\r\n            \r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n    } , \r\n    checkAuth : async () =>{\r\n        try{\r\n            // await axios.get(\"/check-auth\", {withCredentials: true}); // not rquire set default in index.js\r\n            // await axios.get(\"/check-auth\");\r\n            // set({loggedIn : true});\r\n\r\n            const authCheckPromise = axios.get(\"/users/check-auth\");\r\n            await Promise.race([authCheckPromise, new Promise(resolve => setTimeout(resolve, 50000 ))]);\r\n\r\n            set({loggedIn : true});\r\n        }catch(err){\r\n            set({loggedIn : false});\r\n            console.log(err);\r\n            return (\r\n                <Navigate to=\"/users/login\" />\r\n            )\r\n        }\r\n        \r\n    } ,\r\n\r\n    signUpForm:{\r\n        name:\"\",\r\n        user_name:\"\",\r\n        email:\"\",\r\n        password : \"\",\r\n    },\r\n    updateSignUpForm :(e) => {\r\n        const {name , value} = e.target ;\r\n        set((state) => {\r\n            return{\r\n                signUpForm:{\r\n                    ...state.signUpForm,\r\n                    [name] : value\r\n                },\r\n            };\r\n        });\r\n    },\r\n    signUp : async () => {\r\n        try{\r\n            const {signUpForm} = authStore.getState();\r\n            console.log(signUpForm);\r\n            const res = await axios.post(\"/users/signup\",signUpForm,{\r\n                withCredentials: true\r\n            })  \r\n            set({\r\n                signUpForm : {\r\n                    user_name:\"\",\r\n                    email : \"\",\r\n                    password : \"\"\r\n                }\r\n            });\r\n            console.log(res);\r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n    } ,\r\n    logOut : async () =>{\r\n        try{\r\n            const res = await axios.get(\"/users/logout\");\r\n                // localStorage.clear();\r\n                set({loggedIn : false});\r\n                console.log(\"logged_out\");\r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n    }\r\n}));\r\nexport default authStore;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}