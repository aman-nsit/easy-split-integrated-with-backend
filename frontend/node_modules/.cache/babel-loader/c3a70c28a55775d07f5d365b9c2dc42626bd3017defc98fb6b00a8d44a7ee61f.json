{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Aman/Desktop/split-expense/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Aman/Desktop/split-expense/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/Aman/Desktop/split-expense/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/Aman/Desktop/split-expense/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React from'react';import{create}from\"zustand\";import axios from\"axios\";import{Navigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";var authStore=create(function(set){return{loggedIn:null,loginForm:{email:\"\",password:\"\"},updateLoginForm:function updateLoginForm(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;set(function(state){return{loginForm:_objectSpread(_objectSpread({},state.loginForm),{},_defineProperty({},name,value))};});},login:function(){var _login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _authStore$getState,loginForm,item,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_authStore$getState=authStore.getState(),loginForm=_authStore$getState.loginForm;item=localStorage.getItem('accesstoken');console.log(item);_context.next=6;return axios.post(\"/login\",loginForm);case 6:res=_context.sent;// localStorage.setItem(res.data)\n// console.log(res.data.accesstoken);\nlocalStorage.setItem(\"accesstoken\",res.data.accesstoken);set({loggedIn:true,loginForm:{email:\"\",password:\"\"}});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));function login(){return _login.apply(this,arguments);}return login;}(),checkAuth:function(){var _checkAuth=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var authCheckPromise;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;// await axios.get(\"/check-auth\", {withCredentials: true}); // not rquire set default in index.js\n// await axios.get(\"/check-auth\");\n// set({loggedIn : true});\nauthCheckPromise=axios.get(\"/check-auth\");_context2.next=4;return Promise.race([authCheckPromise,new Promise(function(resolve){return setTimeout(resolve,50000);})]);case 4:set({loggedIn:true});_context2.next=13;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(\"done\");set({loggedIn:false});console.log(_context2.t0);return _context2.abrupt(\"return\",/*#__PURE__*/_jsx(Navigate,{to:\"/login\"}));case 13:case\"end\":return _context2.stop();}},_callee2,null,[[0,7]]);}));function checkAuth(){return _checkAuth.apply(this,arguments);}return checkAuth;}(),signUpForm:{email:\"\",password:\"\"},updateSignUpForm:function updateSignUpForm(e){var _e$target2=e.target,name=_e$target2.name,value=_e$target2.value;set(function(state){return{signUpForm:_objectSpread(_objectSpread({},state.signUpForm),{},_defineProperty({},name,value))};});},signUp:function(){var _signUp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var _authStore$getState2,signUpForm,res;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_authStore$getState2=authStore.getState(),signUpForm=_authStore$getState2.signUpForm;_context3.next=4;return axios.post(\"/signup\",signUpForm,{withCredentials:true});case 4:res=_context3.sent;set({signUpForm:{email:\"\",password:\"\"}});console.log(res);_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 12:case\"end\":return _context3.stop();}},_callee3,null,[[0,9]]);}));function signUp(){return _signUp.apply(this,arguments);}return signUp;}(),logOut:function(){var _logOut=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:try{// const res = await axios.get(\"/logout\");\nlocalStorage.clear();set({loggedIn:false});}catch(err){console.log(err);}case 1:case\"end\":return _context4.stop();}},_callee4);}));function logOut(){return _logOut.apply(this,arguments);}return logOut;}()};});export default authStore;","map":{"version":3,"names":["React","create","axios","Navigate","jsx","_jsx","authStore","set","loggedIn","loginForm","email","password","updateLoginForm","e","_e$target","target","name","value","state","_objectSpread","_defineProperty","login","_login","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_authStore$getState","item","res","wrap","_callee$","_context","prev","next","getState","localStorage","getItem","console","log","post","sent","setItem","data","accesstoken","t0","stop","apply","arguments","checkAuth","_checkAuth","_callee2","authCheckPromise","_callee2$","_context2","get","Promise","race","resolve","setTimeout","abrupt","to","signUpForm","updateSignUpForm","_e$target2","signUp","_signUp","_callee3","_authStore$getState2","_callee3$","_context3","withCredentials","logOut","_logOut","_callee4","_callee4$","_context4","clear","err"],"sources":["C:/Users/Aman/Desktop/split-expense/frontend/src/components/AuthStore.js"],"sourcesContent":["import React from 'react';\r\nimport {create} from \"zustand\" ;\r\nimport  axios from \"axios\";\r\nimport { Navigate } from 'react-router-dom';\r\nconst authStore = create((set) => ({\r\n    loggedIn : null ,\r\n\r\n    loginForm:{\r\n        email:\"\",\r\n        password : \"\",\r\n    },\r\n    updateLoginForm :(e) => {\r\n        const {name , value} = e.target ;\r\n        set((state) => {\r\n            return{\r\n                loginForm:{\r\n                    ...state.loginForm,\r\n                    [name] : value\r\n                },\r\n            };\r\n        });\r\n    },\r\n    login : async () =>{\r\n        try{\r\n            const {loginForm} = authStore.getState();\r\n            const item =localStorage.getItem('accesstoken');\r\n            console.log(item)\r\n            const res = await axios.post(\"/login\",loginForm)  \r\n            // localStorage.setItem(res.data)\r\n            // console.log(res.data.accesstoken);\r\n            localStorage.setItem(\"accesstoken\",res.data.accesstoken)\r\n            set(\r\n                {loggedIn:true ,    \r\n                loginForm : {\r\n                    email : \"\",\r\n                    password : \"\"\r\n                }\r\n            });\r\n            \r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n    } , \r\n    checkAuth : async () =>{\r\n        try{\r\n            // await axios.get(\"/check-auth\", {withCredentials: true}); // not rquire set default in index.js\r\n            // await axios.get(\"/check-auth\");\r\n            // set({loggedIn : true});\r\n\r\n            const authCheckPromise = axios.get(\"/check-auth\");\r\n            await Promise.race([authCheckPromise, new Promise(resolve => setTimeout(resolve, 50000 ))]);\r\n\r\n            set({loggedIn : true});\r\n        }catch(err){\r\n            console.log(\"done\");\r\n            set({loggedIn : false});\r\n            console.log(err);\r\n            return (\r\n                <Navigate to=\"/login\" />\r\n            )\r\n        }\r\n        \r\n    } ,\r\n\r\n    signUpForm:{\r\n        email:\"\",\r\n        password : \"\",\r\n    },\r\n    updateSignUpForm :(e) => {\r\n        const {name , value} = e.target ;\r\n        set((state) => {\r\n            return{\r\n                signUpForm:{\r\n                    ...state.signUpForm,\r\n                    [name] : value\r\n                },\r\n            };\r\n        });\r\n    },\r\n    signUp : async () => {\r\n        try{\r\n            const {signUpForm} = authStore.getState();\r\n            const res = await axios.post(\"/signup\",signUpForm,{\r\n                withCredentials: true\r\n            })  \r\n            set({\r\n                signUpForm : {\r\n                    email : \"\",\r\n                    password : \"\"\r\n                }\r\n            });\r\n            console.log(res);\r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n    } ,\r\n    logOut : async () =>{\r\n        try{\r\n            // const res = await axios.get(\"/logout\");\r\n                localStorage.clear();\r\n                set({loggedIn : false});\r\n        }catch(err){\r\n            console.log(err);\r\n        }\r\n    }\r\n\r\n}));\r\nexport default authStore;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}